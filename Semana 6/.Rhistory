library(readxl)
library(tidyr)
datos<- read_excel("datos_anova.xlsx")
data("PlantGrowth")
datos <- as.data.frame(PlantGrowth)
head(datos)
library(dplyr)
# Calcular el promedio de peso por grupo
promedios <- datos %>%
group_by(group) %>%
summarize(mean_weight = mean(weight))
# Ver los promedios
print(promedios)
# Crear el barplot
ggplot(promedios, aes(x = group, y = mean_weight, fill = group)) +
geom_bar(stat = "identity") +
labs(title = "Promedio de peso por grupo", x = "Grupo", y = "Peso Promedio") +
theme_minimal()
library(ggplot2)
# Crear el barplot
ggplot(promedios, aes(x = group, y = mean_weight, fill = group)) +
geom_bar(stat = "identity") +
labs(title = "Promedio de peso por grupo", x = "Grupo", y = "Peso Promedio") +
theme_minimal()
summarise(datos)
str(datos)
# Crear un diagrama de bigotes
boxplot(weight ~ group, data = datos,
main = "Diagrama de Bigotes por Grupo",
xlab = "Grupo", ylab = "Peso",
col = "lightblue", border = "darkblue")
# Using the aggregate function to get summary statistics by group
aggregate(weight ~ group, data = datos, summary)
str(datos)
# Calcular el promedio de peso por grupo
promedios <- datos %>%
group_by(group) %>%
summarize(mean_weight = mean(weight))
# Ver los promedios
print(promedios)
ctrl_df <- datos %>% filter(group == "ctrl")
trt1_df <- datos %>% filter(group == "trt1")
trt2_df <- datos %>% filter(group == "trt2")
summary(ctrl_df)
summary(ctrl_df)
summary(trt1_df)
summary(trt2_df)
#PRUEBA DE NORMALIDAD
# Prueba de normalidad para el grupo "ctrl"
shapiro_ctrl <- shapiro.test(ctrl_df$weight)
print(shapiro_ctrl)
# Prueba de normalidad para el grupo "trt1"
shapiro_trt1 <- shapiro.test(trt1_df$weight)
print(shapiro_trt1)
# Prueba de normalidad para el grupo "trt2"
shapiro_trt2 <- shapiro.test(trt2_df$weight)
print(shapiro_trt2)
#HOMOCEDASTICIDAD
bartlett_test <- bartlett.test(weight ~ group, data = datos)
print(bartlett_test)
#ANOVA
# Realizar ANOVA de una vía
anova_result <- aov(weight ~ group, data = datos)
# Ver los resultados de la ANOVA
summary(anova_result)
unique(group)
unique(datos$group)
datos_tr1 <- datos[datos$group=="tr1"]
datos_tr1 <- datos[datos$group=="tr1",]
#Cuales son las medias y las medianas de peso para cada tratamiento?
# Using the aggregate function to get summary statistics by group
aggregate(weight ~ group, data = datos, summary)
#PRUEBA DE NORMALIDAD
#qqplot
qqnorm(ctrl_df$weight, main = "Q-Q Plot: ctrl")
qqline(ctrl_df$weight, col = "red")
# Genera Q-Q plot para el grupo "ctrl"
qqnorm(ctrl_df$weight, main = "Q-Q Plot: ctrl")
qqline(ctrl_df$weight, col = "red")
# Genera Q-Q plot para el grupo "trt1"
qqnorm(trt1_df$weight, main = "Q-Q Plot: trt1")
qqline(trt1_df$weight, col = "blue")
# Genera Q-Q plot para el grupo "trt2"
qqnorm(trt2_df$weight, main = "Q-Q Plot: trt2")
qqline(trt2_df$weight, col = "yellow")
# Restaurar la configuración de gráficos a su estado predeterminado
par(mfrow = c(1, 1))
# Prueba de normalidad para el grupo "ctrl"
shapiro_ctrl <- shapiro.test(ctrl_df$weight)
#ANOVA
# Realizar ANOVA de una vía
anova_result <- aov(weight ~ group, data = datos)
# Ver los resultados de la ANOVA
summary(anova_result)
plot(anova)
#ANOVA
# Realizar ANOVA de una vía
anova <- aov(weight ~ group, data = datos)
# Ver los resultados de la ANOVA
summary(anova)
plot(anova)
# --- Example 4.14 from Johnson and Wichern --- #
require(tidyverse)
Rigidez <- read_excel("D:/Desktop/Rigidez.xlsx")
LS
DIR
dir()
posthor_resul <- TukeyHSD(anova)
print(posthor_resul)
# --- Example 4.14 from Johnson and Wichern --- #
require(tidyverse)
# --- Example 4.14 from Johnson and Wichern --- #
install.packages('tidyverse')
library('tidyverse')
Rigidez <- read_excel("C:/Users/willi/GITHUB/MULTIVARIATE-ANALYSIS/Parcial 1 - estudio/Rigidez.xlsx")
Datos<-Rigidez %>% as.data.frame()
head(Datos)
par(mfrow=c(2,2))
boxplot(Datos$x1, main=expression(x[1]),xlab="",ylab="")
boxplot(Datos$x2, main=expression(x[2]),xlab="",ylab="")
boxplot(Datos$x3, main=expression(x[3]),xlab="",ylab="")
boxplot(Datos$x4, main=expression(x[4]),xlab="",ylab="")
boxplot(Datos)
par(mfrow=c(1,1))
boxplot(Datos)
qqnorm(Datos$x1, main=expression(x[1]))
qqline(Datos$x1)
qqnorm(ctrl_df)
ctrl_df <- datos %>% filter(group == "ctrl")
qqnorm(ctrl_df)
qqnorm(ctrl_df$weight)
qqline(ctrl_df$weight)
library(readxl)
library(tidyr)
datos<- read_excel("datos_anova.xlsx")
datos <- as.data.frame(t(datos)[2:ncol(datos),])
datos
datos<- read_excel("datos_anova.xlsx")
datos
datos <- as.data.frame(t(datos)[2:ncol(datos),])
datos <- t(datos)
datos
datos
datos <- t(datos)
datos
datos <- as.data.frame(t(datos)[2:ncol(datos),])
datos
datos<- read_excel("datos_anova.xlsx")
datos <- as.data.frame(t(datos)[2:ncol(datos),])
datos
data_long <- gather(datos, Telar, factor_key=TRUE)
data_long$Telar <- as.factor(data_long$Telar)
data_long
# Boxplot con cruce de respuesta y factor
boxplot(data_long$value ~ data_long$Telar, main="Boxplot de resistencia seg?n telar",
ylab="Resistencia", xlab="Telar")
anova<- aov(data_long$value ~ data_long$Telar, data = data_long)
summary(anova)
MSEtratamiento <- summary(anova)[[1]]["data_long$Telar","Mean Sq"]
MSEtratamiento
MSEerror <- summary(anova)[[1]]["Residuals","Mean Sq"]
MSEerror
sigma_error <- MSEerror
sigma_tratamientos <- (MSEtratamiento - MSEerror)/4
sigma_error
sigma_tratamientos
media <- sigma_tratamientos/(sigma_tratamientos+ sigma_error)
media <- sigma_tratamientos/(sigma_tratamientos+ sigma_error)
media
L <- (1/4)*(((MSEtratamiento/MSEerror)*(1/ qf(0.025,4-1,16-4)))-1)
U <- (1/4)*(((MSEtratamiento/MSEerror)*(1/ qf(0.975,4-1,16-4)))-1)
L/(L+1)
U/(U+1)
datos<- read_excel("datos_anova.xlsx", sheet='E1')
datos
datos<- read_excel("datos_anova.xlsx", sheet='E0')
datos
datos<- read_excel("datos_anova.xlsx", sheet='E1')
datos
datos<- as.data.frame(datos[2:ncol(datos),])
datos
datos<- as.data.frame(datos[1:ncol(datos),])
datos
datos<- read_excel("datos_anova.xlsx", sheet='E1')
datos<- as.data.frame(datos[1:ncol(datos),])
datos
datos<- read_excel("datos_anova.xlsx", sheet='E1')
datos
datos<- as.data.frame(datos[1:ncol(datos),])
datos
str(datos)
datos<- read_excel("datos_anova.xlsx", sheet='E1')
datos
str(datos)
datos<- as.data.frame(datos[1:ncol(datos),])
datos
data_long <- gather(datos, Lote, factor_key=TRUE)
data_long$Telar <- as.factor(data_long$Telar)
data_long$Lote <- as.factor(data_long$Telar)
data_long$Lote <- as.factor(data_long$Lote)
data_long
# Boxplot con cruce de respuesta y factor
boxplot(data_long$value ~ data_long$Lote, main="Boxplot de contenido de calcio segun lote",
ylab="Calcio", xlab="Lote")
anova<- aov(data_long$value ~ data_long$Lote, data = data_long)
summary(anova)
MSEtratamiento <- summary(anova)[[1]]["data_long$Lote","Mean Sq"]
MSEtratamiento
MSEerror <- summary(anova)[[1]]["Residuals","Mean Sq"]
MSEerror
sigma_error <- MSEerror
sigma_tratamientos <- (MSEtratamiento - MSEerror)/4
sigma_error
sigma_tratamientos
media <- sigma_tratamientos/(sigma_tratamientos+ sigma_error)
media # La varianza total de los tratamientos explica un 78% de la varianza total.
L <- (1/4)*(((MSEtratamiento/MSEerror)*(1/ qf(0.025,4-1,16-4)))-1)
U <- (1/4)*(((MSEtratamiento/MSEerror)*(1/ qf(0.975,4-1,16-4)))-1)
L/(L+1)
U/(U+1)
residuales <- anova$residuals
qqnorm(residuales)
qqplot(residuales)
qqnorm(residuales)
qqplot(residuales)
qqline(residuales)
shapiro.test(residuales)
#a) ¿Existe alguna diferencia en los tipos de sustancias químicas? Utilizarás un
#nivel de significancia de 𝛼=  0.05
datos<- read_excel("datos_anova.xlsx", sheet='E2')
datos
str(datos)
datos<- as.data.frame(datos[1:ncol(datos),])
datos
#a) ¿Existe alguna diferencia en los tipos de sustancias químicas? Utilizarás un
#nivel de significancia de 𝛼=  0.05
datos<- read_excel("datos_anova.xlsx", sheet='E2')
datos
str(datos)
datos<- as.data.frame(t(datos)[1:ncol(datos),])
datos
str(datos)
datos
#a) ¿Existe alguna diferencia en los tipos de sustancias químicas? Utilizarás un
#nivel de significancia de 𝛼=  0.05
datos<- read_excel("datos_anova.xlsx", sheet='E2')
datos
str(datos)
datos<- as.data.frame(t(datos)[1:ncol(datos),])
str(datos)
datos
#a) ¿Existe alguna diferencia en los tipos de sustancias químicas? Utilizarás un
#nivel de significancia de 𝛼=  0.05
datos<- read_excel("datos_anova.xlsx", sheet='E2')
datos
str(datos)
datos<- as.data.frame(t(datos)[2:ncol(datos),])
datos
#a) ¿Existe alguna diferencia en los tipos de sustancias químicas? Utilizarás un
#nivel de significancia de 𝛼=  0.05
datos<- read_excel("datos_anova.xlsx", sheet='E2')
datos
str(datos)
datos<- as.data.frame(t(datos)[2:nrwo(datos), ])
str(datos)
#a) ¿Existe alguna diferencia en los tipos de sustancias químicas? Utilizarás un
#nivel de significancia de 𝛼=  0.05
datos<- read_excel("datos_anova.xlsx", sheet='E2')
datos
str(datos)
datos<- as.data.frame(t(datos)[2:nrow(datos), ])
str(datos)
datos
